<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Basic Concepts - Hjn4 Blog</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/css/additional.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../homepage.html">HOME - Huy Na</a></li><li class="chapter-item affix "><li class="part-title">AWS</li><li class="chapter-item "><a href="../../blogs/AWS/job.html">Requirements For Job</a></li><li class="chapter-item "><a href="../../blogs/AWS/EC2.html">Computing Services - EC2</a></li><li class="chapter-item "><a href="../../blogs/AWS/IAM.html">Identity and Access Management -IAM</a></li><li class="chapter-item "><a href="../../blogs/AWS/S3.html">Simple Storage Service - S3</a></li><li class="chapter-item "><a href="../../blogs/AWS/LoadBalancing-Autoscaling.html">Load Balancing and Autoscaling</a></li><li class="chapter-item "><a href="../../blogs/AWS/RDS.html">Relational Database Service - RDS</a></li><li class="chapter-item "><a href="../../blogs/AWS/DynamoDB.html">Database Services - No SQL - DynamoDB</a></li><li class="chapter-item "><a href="../../blogs/AWS/Lambda.html">Serverless Lambda</a></li><li class="chapter-item "><a href="../../blogs/AWS/VPC.html">Networking Service - VPC, Peering, Endpoint</a></li><li class="chapter-item "><a href="../../blogs/AWS/Gateway_Cognito.html">API Gateway & Cognito</a></li><li class="chapter-item "><a href="../../blogs/AWS/CloudFront.html">Content Delivery Service (CDN) - CloudFront</a></li><li class="chapter-item "><a href="../../blogs/AWS/Route_53.html">Domain Name System - Route 53</a></li><li class="chapter-item "><a href="../../blogs/AWS/Monitor_Auditing.html">Monitoring and Auditing - CloudWatch, CloudTrail</a></li><li class="chapter-item "><a href="../../blogs/AWS/Mess.html">Messaging Service - SNS, SQS, SES</a></li><li class="chapter-item "><a href="../../blogs/AWS/Event_Bridge.html">Event Bridge</a></li><li class="chapter-item "><a href="../../blogs/AWS/Elastic_Beanstalk.html">Elastic Beanstalk</a></li><li class="chapter-item "><a href="../../blogs/AWS/Container_Service.html">Container Service - ECS, ECR</a></li><li class="chapter-item "><a href="../../blogs/AWS/IAC_CloudFormation.html">Infra as Code - CloudFormation</a></li><li class="chapter-item "><a href="../../blogs/AWS/Backup_Recovery.html">Backup and Recovery</a></li><li class="chapter-item "><a href="../../blogs/AWS/Sec.html">Security Services</a></li><li class="chapter-item affix "><li class="part-title">Kubernetes</li><li class="chapter-item expanded "><a href="../../blogs/Kubernetes/session1.html" class="active">Basic Concepts</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/commands.html">Practice on KodeKloud</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/minkube_deployment.html">MiniKube Deployment</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/data_volume.html">Manage Data & Volumes</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/network.html">Network</a></li><li class="chapter-item affix "><li class="part-title">Linux + Git</li><li class="chapter-item "><a href="../../blogs/Linux/bandit.html">Bandit challenge</a></li><li class="chapter-item "><a href="../../blogs/Linux/command_session_1.html">Command session 1</a></li><li class="chapter-item "><a href="../../blogs/Linux/git_command.html">Git command</a></li><li class="chapter-item "><a href="../../blogs/Linux/ssh.html">SSH</a></li><li class="chapter-item affix "><li class="part-title">Docker</li><li class="chapter-item "><a href="../../blogs/Docker/tips.html">Some docker tips for CTF</a></li><li class="chapter-item "><a href="../../blogs/Docker/get_started.html">Basic Docker</a></li><li class="chapter-item "><a href="../../blogs/Docker/image_container.html">Images & Containers: The Core Building Blocks</a></li><li class="chapter-item "><a href="../../blogs/Docker/dockerfile_write.html">Dockerfile</a></li><li class="chapter-item "><a href="../../blogs/Docker/docker_network.html">Docker Network</a></li><li class="chapter-item "><a href="../../blogs/Docker/Volume.html">Volume</a></li><li class="chapter-item "><a href="../../blogs/Docker/Docker_Compose.html">Docker Compose</a></li><li class="chapter-item affix "><li class="part-title">Terraform</li><li class="chapter-item "><a href="../../blogs/Terraform/overview.html">Overview</a></li><li class="chapter-item "><a href="../../blogs/Terraform/functional_pro.html">Functional Programming</a></li><li class="chapter-item affix "><li class="part-title">Jenkins</li><li class="chapter-item "><a href="../../blogs/Jenkins/install_by_docker.html">Install Jenkins By Docker</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/link_git_jenkins.html">Link git with jenkins</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/pipline_github_jenkins.html">Pipeline jenkinsfile with github</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/gitlab_jenkins.html">Link gitlab with Jenkins</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/gitlab_dockerhub.html">Gitlab-dockerhub-pipeline</a></li><li class="chapter-item affix "><li class="part-title">Python</li><li class="chapter-item "><a href="../../blogs/Python/RE.html">Regular Expression</a></li><li class="chapter-item "><a href="../../blogs/Python/Automation_1.html">Automation with Python 1</a></li><li class="chapter-item affix "><li class="part-title">Bash script</li><li class="chapter-item "><a href="../../blogs/Bash_script/Variables_Environment.html">Shell Variables and Environment</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Conditionals_Execution.html">Conditionals Execution</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Bash_Loops.html">Bash Loops & Function</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Shell_Redirection.html">Shell Redirection & Pipes and Filters</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Interactive_Scripts.html">Interactive Scripts</a></li><li class="chapter-item affix "><li class="part-title">System and Network Administration</li><li class="chapter-item "><a href="../../blogs/Network/basic_network_1.html">Basic Network 1</a></li><li class="chapter-item affix "><li class="part-title">PWN</li><li class="chapter-item "><a href="../../blogs/PWN/Emporium_ROP.html">Rop Emporium</a></li><li class="chapter-item "><a href="../../blogs/PWN/pwnableTW.html">Pwnable.tw</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pico_CTF.html">Pwn_PicoCTF</a></li><li class="chapter-item "><a href="../../blogs/PWN/PWN_from_blabla.html">Pwn from blabla</a></li><li class="chapter-item affix "><li class="part-title">ROP Emporium</li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/ret2win_challenge.html">ret2win - chall 1</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/split_challenge.html">split - chall 2</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/callme_challenge.html">callme - chall 3</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/write4_challenge.html">write4 - chall 4</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/badchars_challenge.html">badchars - chall 5</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/pivot_challenge.html">pivot - chall 7</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/ret2csu_challenge.html">ret2csu - chall 8</a></li><li class="chapter-item affix "><li class="part-title">Pwnable.tw</li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/start_challenge.html">start</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/orw_challenge.html">orw</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/calc_challenge.html">calc</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/3x17_challenge.html">3x17</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/dubblesort_challenge.html">dubblesort</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/silver_bullet_challenge.html">silver_bullet</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/applestore_challenge.html">applestore</a></li><li class="chapter-item affix "><li class="part-title">Pwn_Pico</li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/herelibc_challenge.html">Here's a libc</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/hijacking_challenge.html">hijacking</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/fermat_strins_challenge.html">fermat_strings</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/Guessgame_challenge.html">Guessgame</a></li><li class="chapter-item affix "><li class="part-title">Pwn from blabla</li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/handy_shellcode_challenge.html">handy shellcode</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/pwn07_challenge.html">pwn07 - ret2libc vs ROP</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/got_formatstring_challenge.html">GOT overwrite with format string</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/training.html">training</a></li><li class="chapter-item affix "><li class="part-title">Assembly</li><li class="chapter-item "><a href="../../blogs/Assembly/ASM.html">ASM</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_1.html">Session 1</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_2.html">Session 2</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_3.html">Session 3</a></li><li class="chapter-item affix "><li class="part-title">RE_PicoCTF</li><li class="chapter-item "><a href="../../blogs/RE/RE.html">RE</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_0.html">ARMssembly 0</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_1.html">ARMssembly 1</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_2.html">ARMssembly 2</a></li><li class="chapter-item affix "><li class="part-title">Documents from everywhere</li><li class="chapter-item "><a href="../../blogs/Documents/troubleshooting.html">Troubleshooting</a></li><li class="chapter-item "><a href="../../blogs/Documents/study.html">Study</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Hjn4 Blog</h1>

                    <div class="right-buttons">

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="basic-concepts"><a class="header" href="#basic-concepts">Basic Concepts</a></h1>
<ul>
<li><a href="#cluster-architecture">Cluster Architecture</a></li>
<li><a href="#control-plane">Control Plane</a></li>
<li><a href="#data-plane">Data Plane</a></li>
<li><a href="#yaml">YAML</a></li>
<li><a href="#pod">POD</a></li>
<li><a href="#replicasets">ReplicaSets</a></li>
<li><a href="#deployment">Deployment</a></li>
<li><a href="#service">Service</a></li>
<li><a href="#label--selector">Label &amp; Selector</a></li>
<li><a href="#namespace">Namespace</a></li>
<li><a href="#configmap">ConfigMap</a></li>
<li><a href="#secret">Secret</a></li>
<li><a href="#ingress">Ingress</a></li>
<li><a href="#install-kubectl-on-ubuntu">Install kubectl on ubuntu</a></li>
</ul>
<h2 id="cluster-architecture"><a class="header" href="#cluster-architecture">Cluster Architecture</a></h2>
<p><img src="./image/ss1_cluster.png" alt="alt text" /></p>
<p>Cluster gồm 2 thành phần:</p>
<ul>
<li>Control Plane: Có nhiệm vụ điều phối toàn bộ hoạt động của cluster</li>
<li>Data Plane:
<ul>
<li>Giúp triển khai service</li>
<li>Gồm nhiều worker node</li>
</ul>
</li>
</ul>
<p><img src="./image/k8s_architect.png" alt="alt text" /></p>
<h2 id="control-plane"><a class="header" href="#control-plane">Control Plane</a></h2>
<ul>
<li>
<p><a href="https://kubernetes.io/docs/reference/command-line-tools-reference/">Reference</a></p>
</li>
<li>
<p><strong>kube-apiserver:</strong>: Cho phép quản lý API trong cluster, khi client (CLI interface), Agents, gọi đến cluster, cần lấy thông tin trong cluster thì sẽ gọi đến API Server này. API Server sẽ tiến hành xác thực, phân quyền. Mọi thứ đều phải tương tác qua API Server</p>
</li>
<li>
<p><strong>kube-controller-manager</strong>: Bất kì một controler nào trong cluster k8s đều làm nhiệm vụ monitor một đối tượng nào đó rồi đưa ra hành động tương ứng. Example: quản lý replicaset</p>
</li>
<li>
<p><strong>Scheduler</strong>: Khi mà ta muốn chạy 1 service, thì scheduler sẽ tiến hành tìm các Node hợp lệ (thỏa mản các ràng buộc và có sẵn các tài nguyên cần thiết). Scheduler sẽ rank các valid nodes rồi gán Pod với node hợp lệ</p>
</li>
<li>
<p><strong>etcd</strong>: Như là 1 database chứa toàn bộ data của cluster (objects, resources,...) phục vụ cho mục đích truy cập và tra cứu</p>
</li>
<li>
<p><strong>cloud-controller-manager</strong>(<em>optional</em>): Khi mà ta tự tạo riêng 1 cái cluster k8s nhưng lại muốn sử dụng các tài nguyên như (EC2, S3, ...) trên cloud nói chung, AWS nói riêng thì ta cần đến CCM để có thể tương tác với các service của cloud
<img src="./image/k8s_maternode.png" alt="alt text" /></p>
</li>
</ul>
<h2 id="data-plane"><a class="header" href="#data-plane">Data Plane</a></h2>
<p>Gồm nhiều woker node, trong các woker node thì có 2 thành phần chính:</p>
<ul>
<li><strong>Kubelet</strong>: Như là 1 Agent có trách nhiệm checkin các resource chạy trên woker node(Pod,...) cập nhật thông tin lên API Server, nhận lệnh từ API Server và triển khai trên woker node. Đảm bảo các containers trên các Pod chạy ổn định</li>
<li><strong>Kube-Proxy</strong>: Tạo ra các rule để instance, pod connect với nhau</li>
<li><strong>Container Runtime</strong>: Container runtime là một phần mềm chịu trách nhiệm cho việc quản lý và chạy các container. Nó là một thành phần cụ thể của hệ thống có nhiệm vụ thực hiện các chức năng như tạo, khởi động, dừng và xóa container. Một số container runtime phổ biến trong cộng đồng Kubernetes bao gồm Docker, containerd, rkt, và CRI-O.</li>
<li><strong>Container Runtime Interface</strong>: CRI là một giao diện chuẩn để tương tác giữa Kubernetes và các container runtime. Nó giúp tách biệt logic quản lý container của Kubernetes với container runtime cụ thể, cho phép linh hoạt trong việc thay đổi hoặc sử dụng nhiều container runtime khác nhau.</li>
</ul>
<h2 id="yaml"><a class="header" href="#yaml">YAML</a></h2>
<ul>
<li>Example Json:</li>
</ul>
<pre><code class="language-json">data = {
  &quot;id&quot;: &quot;AWcvsjx864kVeDHDi2gB&quot;,
  &quot;timestamp&quot;: 1542693469197,
  &quot;description&quot;: &quot;This network device leaf2.abc.inc is unreachable from controller. The device role is ACCESS.&quot;,
  &quot;actualServiceId&quot;: &quot;10.10.20.82&quot;,
  &quot;assignedTo&quot;: &quot;&quot;,
  &quot;enrichmentInfo&quot;: {
    &quot;issueDetails&quot;: {
      &quot;issue&quot;: [
        {
          &quot;issueId&quot;: &quot;AWcvsjx864kVeDHDi2gB&quot;,
          &quot;issuePriority&quot;: &quot;&quot;,
          &quot;issueSummary&quot;: &quot;Network Device 10.10.20.82 Is Unreachable From Controller&quot;,
          &quot;issueTimestamp&quot;: 1542693469197,
          &quot;suggestedActions&quot;: [
            {
              &quot;message&quot;: &quot;From the controller, verify whether the last hop is reachable.&quot;,
              &quot;steps&quot;: []
            },
            {
              &quot;message&quot;: &quot;Verify access to the device.&quot;,
              &quot;steps&quot;: []
            }
          ],
          &quot;impactedHosts&quot;: [
            {
              &quot;hostName&quot;: &quot;DUT&quot;,
              &quot;failedAttempts&quot;: 3,
              &quot;location&quot;: {
                &quot;siteId&quot;: &quot;SanJose&quot;,
                &quot;apsImpacted&quot;: []
              },
              &quot;timestamp&quot;: 1542693469197
            }
          ]
        }
      ]
    },
    &quot;connectedDevice&quot;: [
      {
        &quot;deviceDetails&quot;: {
          &quot;inventoryStatusDetail&quot;: &quot;&lt;status&gt;&lt;general code=\&quot;SNMP_TIMEOUT\&quot;/&gt;&lt;/status&gt;&quot;,
          &quot;lastUpdateTime&quot;: 1542693255158,
          &quot;errorDescription&quot;: &quot;SNMP timeouts are occurring with this device. Either the SNMP credentials are not correctly provided to controller or the device is responding slow and snmp timeout is low. If its a timeout issue, controller will attempt to progressively adjust the timeout in subsequent collection cycles to get device to managed state. User can also run discovery again only for this device using the discovery feature after adjusting the timeout and snmp credentials as required. Or user can update the timeout and snmp credentials as required using update credentials.&quot;,
          &quot;tagCount&quot;: &quot;0&quot;,
          &quot;lastUpdated&quot;: &quot;2018-11-20 05:54:15&quot;,
          &quot;id&quot;: &quot;a7633ae5-d3c9-4aea-837d-c3ad5b19c802&quot;,
          &quot;neighborTopology&quot;: [
            {
              &quot;errorCode&quot;: 5000,
              &quot;message&quot;: &quot;An internal has error occurred while processing this request.&quot;,
            }
          ],
          &quot;cisco360view&quot;: &quot;https://10.10.20.22/dna/assurance/home#networkDevice/a7633ae5-d3c9-4aea-837d-c3ad5b19c802&quot;
        }
      }
    ]
  }
}

</code></pre>
<ul>
<li>Convert from json to yaml</li>
</ul>
<pre><code class="language-js">{
  Servers: [
     {
        name: Server1
        owner: John
        created: 2021
        status: Active
     },
    {
        name: Server2
        owner: Huy 
        created: 2024
        status: Active
     }
  ]
}
</code></pre>
<pre><code class="language-yaml">Servers:
  - name: Server1
    owner: John
    created: 2021
    status: Active
  - name: Server2
    owner: Huy
    created: 2024
    status: Active

</code></pre>
<ul>
<li>YAML thường được sử dụng làm ngôn ngữ định nghĩa cấu hình</li>
<li>Data Structure:
<img src="./image/ss1_yaml_1.png" alt="alt text" /></li>
<li>YAML Ain't Markup Language (YAML) là tập cha của JSON, được thiết kế để dễ đọc hơn.</li>
<li>Vì là tập cha của JSON nên các bộ phân tích YAML có thể phân tích các tệp JSON (nhưng ngược lại thì không).</li>
<li>Do vậy, YAML tốt hơn JSON ở một số tác vụ, bao gồm việc nhúng trực tiếp mã JSON (có chứa dấu ngoặc kép) trong các file YAML.</li>
<li>YAML sử dụng thụt lề để xác định phân cấp trong tệp.</li>
<li>Maps và danh sách (list) cũng có thể được biểu diễn khá tương tự như trong JavaScript hoặc Python, dưới dạng gọi là “flow syntax” – cú pháp luồng.</li>
</ul>
<pre><code class="language-js">person:
  name: John
  age: 30
  city: New York

person: {name: John, age: 30, city: New York}
</code></pre>
<pre><code class="language-js">fruits:
  - apple
  - orange
  - banana

fruits: [apple, orange, banana]
</code></pre>
<pre><code class="language-js">people:
  - name: John
    age: 30
    city: New York
  - name: Jane
    age: 25
    city: London


people:
  - {name: John, age: 30, city: New York}
  - {name: Jane, age: 25, city: London}

</code></pre>
<h2 id="pod"><a class="header" href="#pod">POD</a></h2>
<ul>
<li>Là một đối tượng nhỏ nhất được tạo ra bởi k8s</li>
<li>Dùng để đóng gói các Containers vào bên trong</li>
<li>Là một instance của application</li>
<li>Khi Pod đang running nó là thực thể không thể thay đổi (thêm, xóa, sửa)</li>
<li>Scale workload =&gt; tăng Pod =&gt; tăng Host
<img src="./image/ss1_pod_scale.png" alt="alt text" /></li>
<li>Multiple Container in Pod
<img src="./image/ss1_multi_con_pod.png" alt="alt text" />
<ul>
<li><strong>Sidecar Container</strong>: container running song song với container application</li>
<li><strong>Init Container</strong>: container running trước container application</li>
</ul>
</li>
<li>Chỉ nên chạy 1 container trong 1 pod</li>
</ul>
<h2 id="replicasets"><a class="header" href="#replicasets">ReplicaSets</a></h2>
<ul>
<li>ReplicaSet cho phép chạy nhiều bản sao của 1 POD trong Cluster để đảm bảo High Avalibility</li>
<li>Khi application chạy 2 POD, RS cho phép đảm bảo luôn luôn có 2 POD running trong Cluster</li>
</ul>
<h2 id="deployment"><a class="header" href="#deployment">Deployment</a></h2>
<p><img src="./image/deployment_overview.png" alt="alt text" /></p>
<ul>
<li>Khi traffic tăng lên, Kuberentes sẽ không thêm containers vào trong các POD đang chạy mà sẽ thêm các POD khác</li>
<li>POD được coi là immutable object, tức là khi running không thể edit bất cứ thông tin nào ngoại trừ <strong>image</strong></li>
<li>Khi traffic tiếp tục tăng lên và 1 node không thể xử lý được thì K8s sẽ tạo POD trên Host khác</li>
<li><strong>Upgrade/Rollout</strong>: tạo ra một Replicaset mới với các POD với version mới của application</li>
<li><strong>Rollback</strong>: recover lại các POD của replicaset version trước đó</li>
<li><em><strong>Deployment Strategy</strong></em>:
<ul>
<li><strong>Recreate strategy</strong> sẽ kill tất cả các POD của revision cũ trước khi tạo ra các revision mới, gây ra downtime cho application</li>
<li><strong>Rolling Update</strong> thực hiện thay thế dần dần các POD của revision cũ và thay thế bằng các POD của revision mới</li>
</ul>
</li>
</ul>
<h2 id="service"><a class="header" href="#service">Service</a></h2>
<p><img src="./image/service_concept.png" alt="alt text" /></p>
<p><em><strong>In Kubernetes, a Service is a method for exposing a network application that is running as one or more Pods in your cluster.</strong></em></p>
<p><strong>Service types</strong></p>
<p><img src="./image/service_type.png" alt="alt text" /></p>
<ul>
<li><strong>NodePort</strong> cho phép truy cập vào một POD trong Cluster bằng cách mapping với 1 Port nằm trên Node.</li>
<li><strong>ClusterIP</strong> cho phép gắn một IP ảo (Virtual IP) vào Service và cho phép các service khác trong cluster có thể thương tác với service này qua IP đó</li>
<li><strong>LoadBalancer</strong> là service cung cấp bởi các Cloud Provider, nó cho phép truy cập vào service thông qua một LoadBalancer</li>
</ul>
<h3 id="nodeport"><a class="header" href="#nodeport">NodePort</a></h3>
<p><img src="./image/service_nodeport.png" alt="alt text" /></p>
<ul>
<li>
<p>Để định một NodePort service cần chỉ định rõ các Port trên Node (NodePort), Port lắng nghe của Service (Port) và Port lắng nghe của POD (targetPort)</p>
</li>
<li>
<p>Khi tạo một Service với kiểu NodePort, một cổng cố định (NodePort) trên mỗi Node trong Cluster sẽ được mở ra để tiếp nhận yêu cầu. Cổng này là một cổng ngoại vi trên máy chủ vật lý hoặc ảo và có thể được truy cập từ bên ngoài Cluster.</p>
</li>
<li>
<p><strong>Virtual IP (ClusterIP)</strong>: Service cung cấp một địa chỉ IP ảo (ClusterIP) để đại diện cho tất cả các Pod thuộc selector của nó. Khi các yêu cầu đến địa chỉ IP của Service (ClusterIP), cổng NodePort trên Node sẽ chuyển hướng yêu cầu đó đến ClusterIP.</p>
</li>
<li>
<p><strong>Forwarding đến các Pod</strong>: Khi một yêu cầu được gửi đến cổng NodePort trên bất kỳ Node nào trong Cluster, nó sẽ được chuyển hướng đến địa chỉ IP của Service (ClusterIP). ClusterIP sau đó sẽ chuyển hướng yêu cầu đến các Pod phù hợp dựa trên selector theo một cơ chế Round Robin.</p>
</li>
<li>
<p><strong>Round Robin Load Balancing</strong>: Cơ chế Round Robin được sử dụng để chuyển hướng yêu cầu đến các Pod trong tập hợp. Mỗi lần yêu cầu mới đến, nó sẽ được chuyển đến Pod tiếp theo trong danh sách.</p>
</li>
</ul>
<h3 id="clusterip"><a class="header" href="#clusterip">ClusterIP</a></h3>
<p><img src="./image/service_clusterIP.png" alt="alt text" /></p>
<ul>
<li>Được sử dụng để tạo ra một địa chỉ IP ảo (Virtual IP) chỉ có thể truy cập từ bên trong Cluster. ClusterIP không cung cấp khả năng truy cập từ bên ngoài Cluster và thường được sử dụng để nhóm các Pod có cùng chức năng</li>
<li>Khi triển khai một địch vụ thông thường sẽ bao gồm 3 thành phần cơ bản đó là FrontEnd, Backend và DB.</li>
<li>Trong môi trường của Kubernetes, các thành phần này sẽ được triển khai thành các POD gọi là instance. Các POD này về bản chất được Kubernetes cấp cho 1 địa chỉ IP trong suốt vòng đời của nó, tuy nhiên khi POD bị thay thế bởi POD khác thì IP sẽ bị thay đổi.</li>
<li>Vì vậy, kêt nối trực tiếp tới IP của POD là điều không thể. Do đó service ClusterIP được sinh ra như một giao diện đồng nhất cho phép nhóm tất cả các POD có cùng chức năng lại, điều đó khiến cho việc POD bị thay đổi IP sẽ không bị ảnh hưởng tới các thành phần tạo kết nối khác.</li>
</ul>
<h3 id="loadbalancer"><a class="header" href="#loadbalancer">LoadBalancer</a></h3>
<p><img src="./image/service_loadbalancer.png" alt="alt text" /></p>
<h2 id="label--selector"><a class="header" href="#label--selector">Label &amp; Selector</a></h2>
<p><img src="./image/label_selector.png" alt="alt text" /></p>
<p><strong>Label</strong>: Gán nhãn cho object
<strong>Selector</strong>: Lựa chọn loại object có nhãn nào để manage</p>
<h2 id="namespace"><a class="header" href="#namespace">Namespace</a></h2>
<ul>
<li>Namespace cho phép phân tách, tách biệt resources của một Kubernetes Cluster.</li>
<li>Sử dụng Namespace khi cần chia K8s resources cho các team khác nhau, các mục đích khác nhau <em>(dev, test, prod,...)</em></li>
<li>Sử dụng Namespace có thể set các giới hạn về Resources phục vụ việc quản lý tài nguyên</li>
</ul>
<h2 id="configmap"><a class="header" href="#configmap">ConfigMap</a></h2>
<ul>
<li>
<p>Các file cấu hình cho ứng dụng có thể được sử dụng trong Kubernetes dưới dạng ConfigMap</p>
</li>
<li>
<p>ConfigMap được lưu dưới dạng Key-Value</p>
</li>
<li>
<p>Ứng dụng có thể đọc các file cấu hình dưới dạng ConfigMap theo các cách sau:</p>
<ul>
<li>Sử dụng biến môi trường Environment Variables (printenv)</li>
<li>Sử dụng Volumes</li>
</ul>
</li>
<li>
<p>ConfigMap có thể dùng để lưu một file cấu hình đầy đủ <em>(VD. nginx.conf, application.properties)</em></p>
</li>
<li>
<p>Sau đó ConfigMap được mount vào thư mục đặt file cấu hình của ứng dụng trong container sử dụng Volumes.Bằng cách này chúng ta có thể đưa file cấu hình vào trong Container mà không cần thay đổi gì với Container</p>
</li>
<li>
<p>Generate ConfigMap sử dụng declarative yaml file</p>
</li>
</ul>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: webapp-config-map
data:
  APP_COLOR: darkblue
  APP_OTHER: disregard

</code></pre>
<ul>
<li>Expose ConfigMap sử dụng Environment Variables</li>
</ul>
<pre><code class="language-yaml"># non configmap
- env:
    - name: APP_COLOR
      value: green
</code></pre>
<pre><code class="language-yaml"># use configmap
- env:
    - name: APP_COLOR
      valueFrom:
        configMapKeyRef: 
          name: webapp-config-map
          key: APP_COLOR

</code></pre>
<h2 id="secret"><a class="header" href="#secret">Secret</a></h2>
<ul>
<li>
<p>Secrets là cách mà Kubernetes cung cấp để chia sẻ các thông nhạy cảm <em>(user/pass, token, key…)</em>, là cách đơn giản nhất để truyền các tham số nhạy cảm</p>
</li>
<li>
<p>Ngoài Secrets còn có thể dùng dịch vụ khác thay thế như <strong>Hashicorp Vault</strong></p>
</li>
<li>
<p>Ứng dụng có thể sử dụng Secret theo các cách sau</p>
<ul>
<li>Sử dụng Secret như là các biến môi trường (environment variables)</li>
<li>Sử dụng Secret như là một file: volumes để mount vào Container</li>
</ul>
</li>
</ul>
<p>Volume:</p>
<pre><code class="language-yaml">spec:
  containers:
  - name: mynodejs
    image:  nodejs
    volumeMounts:
      - name: credential-volume
        mountPath: /etc/creds
  volumes:
    - name: credential-volume
      secret:
        secretName: db-secret
</code></pre>
<p><a href="./commands.html">For more</a></p>
<h2 id="ingress"><a class="header" href="#ingress">Ingress</a></h2>
<ul>
<li>Ingress là một phương án để expose service ra bên ngoài thay thế cho NodePort hoặc LoadBalancer type</li>
<li>Ingress cho phép định tuyến các traffic từ bên ngoài vào các service bên trong K8s theo các rule được định nghĩa:
<ul>
<li>Host name</li>
<li>URL Path</li>
</ul>
</li>
</ul>
<p><img src="./image/ingress_1.png" alt="alt text" /></p>
<ul>
<li>
<p><strong>Ingress Resource</strong> là Object cho phép định nghĩa cách các request từ bên ngoài vào được định tuyến tới các Service như thế nào trong K8s Cluster</p>
</li>
<li>
<p><strong>Ingress Controller</strong>:</p>
<ul>
<li>Ingress Controller đóng vai trò là Proxy và thực hiện tiếp nhận request từ bên ngoài và chuyển hướng tới các dịch vụ Service bên trong Cluster K8s</li>
<li>Ingress Controller sẽ lắng nghe việc tạo ra các Ingress Resource và apply các rule định nghĩa trong Ingress Resource vào cấu hình Proxy của nó</li>
</ul>
</li>
<li>
<p><strong>Ingress Rules</strong>:</p>
<ul>
<li>Là một phần của Ingress Resources trong Kubernetes. Một Ingress Resources định nghĩa cách yêu cầu HTTP/HTTPS nên được điều hướng đến các dịch vụ trong cluster. Mỗi Ingress Rule chứa một hoặc nhiều quy tắc để xác định cách yêu cầu nên được xử lý.</li>
<li>Các quy tắc này được đặc tả trong trường spec.rules của Ingress Resources và có thể bao gồm các thông tin như địa chỉ đích, path, port, và backend service.</li>
</ul>
</li>
</ul>
<h2 id="install-kubectl-on-ubuntu-or-wsl2"><a class="header" href="#install-kubectl-on-ubuntu-or-wsl2">Install kubectl on ubuntu or wsl2</a></h2>
<pre><code class="language-py">curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;

sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl

kubectl version --client

</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../blogs/AWS/Sec.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../blogs/Kubernetes/commands.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../blogs/AWS/Sec.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../blogs/Kubernetes/commands.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
