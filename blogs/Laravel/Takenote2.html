<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Take note 2 - Hjn4 Blog</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/css/additional.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../homepage.html">HOME - Huy Na</a></li><li class="chapter-item affix "><li class="part-title">AWS</li><li class="chapter-item "><a href="../../blogs/AWS/job.html">Requirements For Job</a></li><li class="chapter-item "><a href="../../blogs/AWS/EC2.html">Computing Services - EC2</a></li><li class="chapter-item "><a href="../../blogs/AWS/IAM.html">Identity and Access Management -IAM</a></li><li class="chapter-item "><a href="../../blogs/AWS/S3.html">Simple Storage Service - S3</a></li><li class="chapter-item "><a href="../../blogs/AWS/LoadBalancing-Autoscaling.html">Load Balancing and Autoscaling</a></li><li class="chapter-item "><a href="../../blogs/AWS/RDS.html">Relational Database Service - RDS</a></li><li class="chapter-item "><a href="../../blogs/AWS/DynamoDB.html">Database Services - No SQL - DynamoDB</a></li><li class="chapter-item "><a href="../../blogs/AWS/Lambda.html">Serverless Lambda</a></li><li class="chapter-item "><a href="../../blogs/AWS/VPC.html">Networking Service - VPC, Peering, Endpoint</a></li><li class="chapter-item "><a href="../../blogs/AWS/Gateway_Cognito.html">API Gateway & Cognito</a></li><li class="chapter-item "><a href="../../blogs/AWS/CloudFront.html">Content Delivery Service (CDN) - CloudFront</a></li><li class="chapter-item "><a href="../../blogs/AWS/Route_53.html">Domain Name System - Route 53</a></li><li class="chapter-item "><a href="../../blogs/AWS/Monitor_Auditing.html">Monitoring and Auditing - CloudWatch, CloudTrail</a></li><li class="chapter-item "><a href="../../blogs/AWS/Mess.html">Messaging Service - SNS, SQS, SES</a></li><li class="chapter-item "><a href="../../blogs/AWS/Event_Bridge.html">Event Bridge</a></li><li class="chapter-item "><a href="../../blogs/AWS/Elastic_Beanstalk.html">Elastic Beanstalk</a></li><li class="chapter-item "><a href="../../blogs/AWS/Container_Service.html">Container Service - ECS, ECR</a></li><li class="chapter-item "><a href="../../blogs/AWS/IAC_CloudFormation.html">Infra as Code - CloudFormation</a></li><li class="chapter-item "><a href="../../blogs/AWS/Backup_Recovery.html">Backup and Recovery</a></li><li class="chapter-item "><a href="../../blogs/AWS/Sec.html">Security Services</a></li><li class="chapter-item affix "><li class="part-title">PHP</li><li class="chapter-item "><a href="../../blogs/PHP/setup_env.html">Setup Environment</a></li><li class="chapter-item "><a href="../../blogs/PHP/basic.html">Basic Concepts</a></li><li class="chapter-item "><a href="../../blogs/PHP/mysqli.html">MySQLi</a></li><li class="chapter-item "><a href="../../blogs/PHP/sort_algorithms.html">Sort Algorithms</a></li><li class="chapter-item "><a href="../../blogs/PHP/hackerrank_algorithms.html">Hackerrank</a></li><li class="chapter-item "><a href="../../blogs/PHP/Interview.html">Interview</a></li><li class="chapter-item affix "><li class="part-title">Laravel</li><li class="chapter-item "><a href="../../blogs/Laravel/setup_env.html">Setup Environment</a></li><li class="chapter-item "><a href="../../blogs/Laravel/artisanCommand.html">Artisan Command</a></li><li class="chapter-item "><a href="../../blogs/Laravel/Takenote.html">Take note 1</a></li><li class="chapter-item expanded "><a href="../../blogs/Laravel/Takenote2.html" class="active">Take note 2</a></li><li class="chapter-item "><a href="../../blogs/Laravel/Takenote3.html">Take note 3</a></li><li class="chapter-item "><a href="../../blogs/Laravel/Takenote4.html">Take note 4</a></li><li class="chapter-item "><a href="../../blogs/Laravel/advance_concepts.html">Advance Concepts</a></li><li class="chapter-item "><a href="../../blogs/Laravel/database.html">Database</a></li><li class="chapter-item "><a href="../../blogs/Laravel/explain_functions.html">Explain Functions</a></li><li class="chapter-item affix "><li class="part-title">Kubernetes</li><li class="chapter-item "><a href="../../blogs/Kubernetes/session1.html">Basic Concepts</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/commands.html">Practice on KodeKloud</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/minkube_deployment.html">MiniKube Deployment</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/data_volume.html">Manage Data & Volumes</a></li><li class="chapter-item "><a href="../../blogs/Kubernetes/network.html">Network</a></li><li class="chapter-item affix "><li class="part-title">Linux + Git</li><li class="chapter-item "><a href="../../blogs/Linux/bandit.html">Bandit challenge</a></li><li class="chapter-item "><a href="../../blogs/Linux/command_session_1.html">Command session 1</a></li><li class="chapter-item "><a href="../../blogs/Linux/git_command.html">Git command</a></li><li class="chapter-item "><a href="../../blogs/Linux/ssh.html">SSH</a></li><li class="chapter-item "><a href="../../blogs/Linux/conda.html">Conda</a></li><li class="chapter-item affix "><li class="part-title">Docker</li><li class="chapter-item "><a href="../../blogs/Docker/tips.html">Some docker tips for CTF</a></li><li class="chapter-item "><a href="../../blogs/Docker/get_started.html">Basic Docker</a></li><li class="chapter-item "><a href="../../blogs/Docker/image_container.html">Images & Containers: The Core Building Blocks</a></li><li class="chapter-item "><a href="../../blogs/Docker/dockerfile_write.html">Dockerfile</a></li><li class="chapter-item "><a href="../../blogs/Docker/docker_network.html">Docker Network</a></li><li class="chapter-item "><a href="../../blogs/Docker/Volume.html">Volume</a></li><li class="chapter-item "><a href="../../blogs/Docker/Docker_Compose.html">Docker Compose</a></li><li class="chapter-item affix "><li class="part-title">Terraform</li><li class="chapter-item "><a href="../../blogs/Terraform/overview.html">Overview</a></li><li class="chapter-item "><a href="../../blogs/Terraform/functional_pro.html">Functional Programming</a></li><li class="chapter-item "><a href="../../blogs/Terraform/Module_create_VPC.html">Terraform Module: Create VPC on AWS</a></li><li class="chapter-item affix "><li class="part-title">Jenkins</li><li class="chapter-item "><a href="../../blogs/Jenkins/install_by_docker.html">Install Jenkins By Docker</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/link_git_jenkins.html">Link git with jenkins</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/pipline_github_jenkins.html">Pipeline jenkinsfile with github</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/gitlab_jenkins.html">Link gitlab with Jenkins</a></li><li class="chapter-item "><a href="../../blogs/Jenkins/gitlab_dockerhub.html">Gitlab-dockerhub-pipeline</a></li><li class="chapter-item affix "><li class="part-title">CSS</li><li class="chapter-item "><a href="../../blogs/CSS/basic.html">Basic Concepts</a></li><li class="chapter-item "><a href="../../blogs/CSS/flexbox.html">Flexbox CSS</a></li><li class="chapter-item "><a href="../../blogs/CSS/BEM.html">BEM</a></li><li class="chapter-item "><a href="../../blogs/CSS/responsive.html">Resposive</a></li><li class="chapter-item "><a href="../../blogs/CSS/tranform_sitsion_anima.html">Transform - Transition - Animation</a></li><li class="chapter-item affix "><li class="part-title">JS</li><li class="chapter-item "><a href="../../blogs/JS/basic.html">Basic Concepts 1</a></li><li class="chapter-item "><a href="../../blogs/JS/dom.html">DOM</a></li><li class="chapter-item "><a href="../../blogs/JS/basic2.html">Basic Concepts 2</a></li><li class="chapter-item affix "><li class="part-title">Python</li><li class="chapter-item "><a href="../../blogs/Python/RE.html">Regular Expression</a></li><li class="chapter-item "><a href="../../blogs/Python/Automation_1.html">Automation with Python 1</a></li><li class="chapter-item affix "><li class="part-title">Bash script</li><li class="chapter-item "><a href="../../blogs/Bash_script/Variables_Environment.html">Shell Variables and Environment</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Conditionals_Execution.html">Conditionals Execution</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Bash_Loops.html">Bash Loops & Function</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Shell_Redirection.html">Shell Redirection & Pipes and Filters</a></li><li class="chapter-item "><a href="../../blogs/Bash_script/Interactive_Scripts.html">Interactive Scripts</a></li><li class="chapter-item affix "><li class="part-title">System and Network Administration</li><li class="chapter-item "><a href="../../blogs/Network/basic_network_1.html">Basic Network 1</a></li><li class="chapter-item affix "><li class="part-title">PWN</li><li class="chapter-item "><a href="../../blogs/PWN/Emporium_ROP.html">Rop Emporium</a></li><li class="chapter-item "><a href="../../blogs/PWN/pwnableTW.html">Pwnable.tw</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pico_CTF.html">Pwn_PicoCTF</a></li><li class="chapter-item "><a href="../../blogs/PWN/PWN_from_blabla.html">Pwn from blabla</a></li><li class="chapter-item affix "><li class="part-title">ROP Emporium</li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/ret2win_challenge.html">ret2win - chall 1</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/split_challenge.html">split - chall 2</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/callme_challenge.html">callme - chall 3</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/write4_challenge.html">write4 - chall 4</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/badchars_challenge.html">badchars - chall 5</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/pivot_challenge.html">pivot - chall 7</a></li><li class="chapter-item "><a href="../../blogs/PWN/ROP_Emporium/ret2csu_challenge.html">ret2csu - chall 8</a></li><li class="chapter-item affix "><li class="part-title">Pwnable.tw</li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/start_challenge.html">start</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/orw_challenge.html">orw</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/calc_challenge.html">calc</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/3x17_challenge.html">3x17</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/dubblesort_challenge.html">dubblesort</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/silver_bullet_challenge.html">silver_bullet</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwnable_tw/applestore_challenge.html">applestore</a></li><li class="chapter-item affix "><li class="part-title">Pwn_Pico</li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/herelibc_challenge.html">Here's a libc</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/hijacking_challenge.html">hijacking</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/fermat_strins_challenge.html">fermat_strings</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_Pico/Guessgame_challenge.html">Guessgame</a></li><li class="chapter-item affix "><li class="part-title">Pwn from blabla</li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/handy_shellcode_challenge.html">handy shellcode</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/pwn07_challenge.html">pwn07 - ret2libc vs ROP</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/got_formatstring_challenge.html">GOT overwrite with format string</a></li><li class="chapter-item "><a href="../../blogs/PWN/Pwn_from_blabla/training.html">training</a></li><li class="chapter-item affix "><li class="part-title">Assembly</li><li class="chapter-item "><a href="../../blogs/Assembly/ASM.html">ASM</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_1.html">Session 1</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_2.html">Session 2</a></li><li class="chapter-item "><a href="../../blogs/Assembly/Session_3.html">Session 3</a></li><li class="chapter-item affix "><li class="part-title">RE_PicoCTF</li><li class="chapter-item "><a href="../../blogs/RE/RE.html">RE</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_0.html">ARMssembly 0</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_1.html">ARMssembly 1</a></li><li class="chapter-item "><a href="../../blogs/RE_Pico/ARMssembly_2.html">ARMssembly 2</a></li><li class="chapter-item affix "><li class="part-title">Documents from everywhere</li><li class="chapter-item "><a href="../../blogs/Documents/troubleshooting.html">Troubleshooting</a></li><li class="chapter-item "><a href="../../blogs/Documents/study.html">Study</a></li><li class="chapter-item "><a href="../../blogs/Documents/important_concept.html">Important Concepts</a></li><li class="chapter-item "><a href="../../blogs/Documents/basic_SQL.html">MySQL</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Hjn4 Blog</h1>

                    <div class="right-buttons">

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="take-note-2"><a class="header" href="#take-note-2">Take note 2</a></h1>
<ul>
<li><a href="#resource-controller-route---method">Resource controller: route - method</a></li>
<li><a href="#use-tinymce-editor---call-api">Use TinyMCE editor - Call API</a></li>
<li><a href="#use-removebg---remove-background">Use removebg - Remove background</a></li>
<li><a href="#get-products-by-category---save-old-select">Get Products By Category - Save Old Select</a></li>
<li><a href="#belongto---hasmany-render-category-from-product">BelongTo - HasMany: Render category from product</a></li>
<li><a href="#posttoolargeexception">PostTooLargeException</a></li>
<li><a href="#user-login---register---logout---default-guard">User Login - Register - Logout - Default Guard</a></li>
<li><a href="#admin---login---logout---custom-guard">Admin - Login - Logout - Custom Guard</a></li>
</ul>
<h2 id="resource-controller-route---method"><a class="header" href="#resource-controller-route---method">Resource controller: route - method</a></h2>
<ul>
<li>
<p><a href="https://laravel.com/docs/11.x/controllers#actions-handled-by-resource-controllers">ref</a></p>
</li>
<li>
<p><strong>route</strong>:</p>
</li>
</ul>
<pre><code class="language-php">// route
Route::get('categories', [CategoryController::class, 'index'])
    -&gt;name('admin.categories.index');

Route::get('categories/create', [CategoryController::class, 'create'])
    -&gt;name('admin.categories.create');

Route::post('categories', [CategoryController::class, 'store'])
    -&gt;name('admin.categories.store');

Route::get('categories/{category}/edit', [CategoryController::class, 'edit'])
    -&gt;name('admin.categories.edit');

Route::put('categories/{category}', [CategoryController::class, 'update'])
    -&gt;name('admin.categories.update');

Route::delete('categories/{category}', [CategoryController::class, 'destroy'])
    -&gt;name('admin.categories.destroy');
// --------------------------------------------------------------

</code></pre>
<ul>
<li><strong>CategoryController</strong>:</li>
</ul>
<pre><code class="language-php">namespace App\Http\Controllers;

use App\Http\Requests\StoreCategoryRequest;
use App\Http\Requests\UpdateCategoryRequest;
use App\Models\Category;
use App\Services\Interfaces\CategoryServiceInterface;

class CategoryController extends Controller
{
    protected $categoryService;

    public function __construct(
        CategoryServiceInterface $categoryService
    ) {
        $this-&gt;categoryService = $categoryService;
    }

    /**
     * Display a listing of the resource.
     */
    public function index()
    {
        $categories = $this-&gt;categoryService-&gt;getAll();
        return view('admin.pages.category.categories', [
            'categories' =&gt; $categories,
            'page' =&gt; 'Categories',
        ]);
    }

    /**
     * Show the form for creating a new resource.
     */
    public function create()
    {
        return view('admin.pages.category.createCategory', [
            'parentPage' =&gt; ['Categories', 'admin.categories.index'],
            'childPage' =&gt; 'Create',
        ]);
    }

    /**
     * Store a newly created resource in storage.
     */
    public function store(StoreCategoryRequest $request)
    {
        $validatedData = $request-&gt;validated();
        if ($this-&gt;categoryService-&gt;store($validatedData)) {
            return redirect()-&gt;route('admin.categories.index')-&gt;with('success', 'Create Category successfully');
        }
        return back()-&gt;withErrors('Failed to create category.');
    }

    /**
     * Display the specified resource.
     */
    public function show(Category $category)
    {
        //
    }

    /**
     * Show the form for editing the specified resource.
     */
    public function edit(Category $category)
    {
        return view('admin.pages.category.editCategory', [
            'category' =&gt; $category,
            'parentPage' =&gt; ['Categories', 'admin.categories.index'],
            'childPage' =&gt; 'Edit',
        ]);
    }

    /**
     * Update the specified resource in storage.
     */
    public function update(UpdateCategoryRequest $request, Category $category)
    {
        $validatedData = $request-&gt;validated();
        if ($this-&gt;categoryService-&gt;update($category, $validatedData)) {
            return redirect()-&gt;route('admin.categories.index')-&gt;with('success', 'Update Category successfully');
        }
        return back()-&gt;withErrors('Failed to update category.');
    }

    /**
     * Remove the specified resource from storage.
     */
    public function destroy(Category $category)
    {
        if ($this-&gt;categoryService-&gt;delete($category)) {
            return redirect()-&gt;route('admin.categories.index')-&gt;with('success', 'Delete Category successfully');
        }
        return back()-&gt;withErrors('Failed to delete category.');
    }
}


</code></pre>
<ul>
<li><strong>CategoryService</strong>:</li>
</ul>
<pre><code class="language-php">namespace App\Services;

use App\Services\Interfaces\CategoryServiceInterface;
use App\Models\Category;

/**
 * Class CategoryService
 * @package App\Services
 */
class CategoryService implements CategoryServiceInterface
{
    public function getAll()
    {
        return Category::all();
    }

    public function store($validatedData)
    {
        return Category::create($validatedData);
    }

    public function update(Category $category, $validatedData)
    {
        return $category-&gt;update($validatedData);
    }

    public function delete(Category $category)
    {
        return $category-&gt;delete();
    }
}

</code></pre>
<h2 id="use-tinymce-editor---call-api"><a class="header" href="#use-tinymce-editor---call-api">Use TinyMCE editor - Call API</a></h2>
<ul>
<li>
<p><a href="https://www.tiny.cloud/docs/tinymce/latest/laravel-tiny-cloud/">ref</a></p>
</li>
<li>
<p><strong>file.blade.php</strong>:</p>
</li>
</ul>
<pre><code class="language-php">&lt;script src=&quot;https://cdn.tiny.cloud/1/{{ env('TinyMCE_API_KEY') }}/tinymce/7/tinymce.min.js&quot; referrerpolicy=&quot;origin&quot;&gt;
&lt;/script&gt;
&lt;script&gt;
    tinymce.init({
        selector: 'textarea#editorTinyMCE', // Replace this CSS selector to match the placeholder element for TinyMCE
        // plugins: 'code table lists',
        plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount checklist mediaembed casechange export formatpainter pageembed linkchecker a11ychecker tinymcespellchecker permanentpen powerpaste advtable advcode editimage advtemplate mentions tableofcontents footnotes mergetags autocorrect typography inlinecss markdown',
        toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat',
        // toolbar: 'undo redo | blocks | bold italic | alignleft aligncenter alignright | indent outdent | bullist numlist | code | table'
    });
&lt;/script&gt;

</code></pre>
<ul>
<li><strong>View</strong>:</li>
</ul>
<pre><code class="language-html">&lt;div class=&quot;form-group row&quot;&gt;
    &lt;label class=&quot;col-sm-2 col-form-label&quot;&gt;Describe&lt;/label&gt;
    &lt;div class=&quot;col-sm-10&quot;&gt;
        &lt;textarea id=&quot;editorTinyMCE&quot; name=&quot;describe&quot; rows=&quot;5&quot; cols=&quot;5&quot; class=&quot;form-control&quot;
            placeholder=&quot;Typing ...&quot;&gt;&lt;/textarea&gt;
    &lt;/div&gt;
&lt;/div&gt;

</code></pre>
<h2 id="use-removebg---remove-background"><a class="header" href="#use-removebg---remove-background">Use removebg - Remove background</a></h2>
<ul>
<li>
<p><strong>composer require guzzlehttp/guzzle</strong></p>
</li>
<li>
<p><strong>Use Intervention: version 2.7.*</strong>: <a href="https://www.youtube.com/watch?v=-E3amn3gGFo">ref</a></p>
<ul>
<li><em>composer require intervention/image:2.7.*</em></li>
<li><em>use Intervention\Image\Facades\Image;</em></li>
</ul>
</li>
<li>
<p><strong>ProductController</strong>:</p>
</li>
</ul>
<pre><code class="language-php">public function store(StoreProductRequest $request)
{
    // dd($request);
    $validatedData = $request-&gt;validated();
    if ($request-&gt;hasFile('image')) {
        $path = $this-&gt;imageService-&gt;removeBackgroundAndStore($request);
        $validatedData['image'] = $path;
    }
    if ($this-&gt;productService-&gt;store($validatedData)) {
        return redirect()-&gt;route('admin.products.index')-&gt;with('success', 'Create product successfully');
    }
    return back()-&gt;withErrors('Failed to create product.');
}

public function update(UpdateProductRequest $request, Product $product)
{
    $validatedData = $request-&gt;validated();
    $oldImagePath = $product-&gt;image;

    if ($request-&gt;hasFile('image')) {
        $path = $this-&gt;imageService-&gt;removeBackgroundAndStore($request);
        $validatedData['image'] = $path;
    }

    if ($this-&gt;productService-&gt;update($product, $validatedData)) {
        if ($oldImagePath &amp;&amp; $oldImagePath != $product-&gt;image) {
            $this-&gt;imageService-&gt;deleteImage($oldImagePath); // Xóa ảnh cũ nếu cập nhật ảnh mới thành công
        }

        return redirect()-&gt;route('admin.products.index')-&gt;with('success', 'Update product successfully');
    }
    return back()-&gt;withErrors('Failed to update product.');
}
</code></pre>
<ul>
<li><strong>Request Rule</strong>:</li>
</ul>
<pre><code class="language-php">public function rules(): array
{
    return [
        //...
        'image' =&gt; 'required|image|mimes:jpeg,jpg,png,webp|max:2048',
        //...
    ];
}

</code></pre>
<ul>
<li><strong>ImageService</strong>:</li>
</ul>
<pre><code class="language-php">public function removeBackgroundAndStore(Request $request)
    {
        if ($request-&gt;hasFile('image')) {
            $file = $request-&gt;file('image');
            $image = Image::make($file);

            if (!in_array($image-&gt;mime(), ['image/png'])) {
                $image = $image-&gt;encode('png');
            }

            $filename = time() . '_' . uniqid() . '.png';
            $tempPath = sys_get_temp_dir() . '/' . $filename;

            $image-&gt;save($tempPath);

            $client = new \GuzzleHttp\Client();
            $response = $client-&gt;post('https://api.remove.bg/v1.0/removebg', [
                'multipart' =&gt; [
                    [
                        'name'     =&gt; 'image_file',
                        'contents' =&gt; fopen($tempPath, 'r')
                    ],
                    [
                        'name'     =&gt; 'size',
                        'contents' =&gt; 'auto'
                    ]
                ],
                'headers' =&gt; [
                    'X-Api-Key' =&gt; env('REMOVE_BG_API_KEY')
                ]
            ]);

            $path = 'storage/images/products/' . $filename;
            Storage::disk('public')-&gt;put('images/products/' . $filename, $response-&gt;getBody());

            unlink($tempPath);

            return $path;
        }

        throw new Exception('No image uploaded or failed to remove background');
        return true;
    }

    public function deleteImage($ImagePath)
    {
        $ImagePath = str_replace('storage/', '', $ImagePath);
        Storage::disk('public')-&gt;delete($ImagePath);
    }
</code></pre>
<h2 id="get-products-by-category---save-old-select"><a class="header" href="#get-products-by-category---save-old-select">Get Products By Category - Save Old Select</a></h2>
<ul>
<li>Route:</li>
</ul>
<pre><code class="language-php">Route::get('products/category/{category}', [ProductController::class, 'indexByCategory'])
    -&gt;name('admin.products.byCategory');

</code></pre>
<ul>
<li>View:</li>
</ul>
<pre><code class="language-php">&lt;form class=&quot;form-material&quot; method=&quot;get&quot; action=&quot;&quot; id=&quot;categoryForm&quot;&gt;
    @csrf
    &lt;div class=&quot;form-group row&quot;&gt;
        &lt;label class=&quot;col-sm-2 col-form-label&quot;&gt;Choose Category&lt;/label&gt;
        &lt;div class=&quot;col-sm-6&quot;&gt;
            &lt;select name=&quot;category&quot; class=&quot;form-control select2-format&quot;
                id=&quot;categorySelect&quot;&gt;
                &lt;option value=&quot;all&quot;
                    {{ session('selectedCategory') == 'all' ? 'selected' : '' }}&gt;All
                &lt;/option&gt;
                @foreach ($categories as $category)
                    &lt;option value=&quot;{{ $category-&gt;id }}&quot;
                        {{ session('selectedCategory') == $category-&gt;id ? 'selected' : '' }}&gt;
                        {{ $category-&gt;name }}
                    &lt;/option&gt;
                @endforeach
            &lt;/select&gt;

        &lt;/div&gt; 
    &lt;/div&gt;
&lt;/form&gt;

</code></pre>
<ul>
<li><strong>Script</strong>:</li>
</ul>
<pre><code class="language-html">&lt;script&gt;
    document.getElementById('categorySelect').addEventListener('change', function() {
        var selectedCategory = this.value;
        var form = document.getElementById('categoryForm');
        if (selectedCategory == 'all') {
            form.action = '{{ route('admin.products.index') }}';
        } else {
            form.action = '{{ route('admin.products.byCategory', '') }}/' + selectedCategory;
        }
        form.submit(); // Tự động gửi form sau khi lựa chọn thay đổi
    });
&lt;/script&gt;

</code></pre>
<ul>
<li><strong>ProductController</strong>: <em>Save selected in session</em></li>
</ul>
<pre><code class="language-php">public function index()
{
    $products = $this-&gt;productService-&gt;getAll();
    $categories = $this-&gt;productService-&gt;getAllCategories();
    session(['selectedCategory' =&gt; 'all']); //
    return view('admin.pages.product.products', [
        'selectedCategory' =&gt; 'all', //
        'products' =&gt; $products,
        'categories' =&gt; $categories,
        'page' =&gt; 'Products',
    ]);
}

public function indexByCategory(Category $category)
{
    $categories = $this-&gt;productService-&gt;getAllCategories();
    $products = $this-&gt;productService-&gt;getProductsByCategory($category);
    // dd($products);
    session(['selectedCategory' =&gt; $category-&gt;id]); //
    return view('admin.pages.product.products', [
        'selectedCategory' =&gt; $category-&gt;id, //
        'categories' =&gt; $categories,
        'products' =&gt; $products,
        'page' =&gt; 'Products',
    ]);
}

</code></pre>
<h2 id="belongto---hasmany-render-category-from-product"><a class="header" href="#belongto---hasmany-render-category-from-product">BelongTo - HasMany: Render category from product</a></h2>
<p><em>Truy xuẩt qua lại: VD: Lấy category của product thông qua categoryId</em></p>
<ul>
<li><strong>Model</strong>:</li>
</ul>
<pre><code class="language-php">// category
public function products()
{
    return $this-&gt;hasMany(Product::class, 'categoryId');
}

// product
public function category()
{
    return $this-&gt;belongsTo(Category::class, 'categoryId');
}

</code></pre>
<ul>
<li><strong>Service - Method</strong>:</li>
</ul>
<pre><code class="language-php">public function getProductsByCategory(Category $category)
{
    // return $category-&gt;products;
    return Product::with('category')-&gt;where('categoryId', $category-&gt;id)-&gt;get();
}


public function getAll()
{
    // return Category::all(); 
    return Category::with('products')-&gt;get();
}

</code></pre>
<ul>
<li><strong>View</strong>:</li>
</ul>
<pre><code class="language-php">&lt;td class=&quot;text-center&quot;&gt;{{ $product-&gt;category-&gt;name }}&lt;/td&gt;

&lt;td class=&quot;text-center&quot;&gt;{{ $category-&gt;products-&gt;count() }}&lt;/td&gt;
</code></pre>
<h2 id="posttoolargeexception"><a class="header" href="#posttoolargeexception">PostTooLargeException</a></h2>
<ul>
<li><a href="https://medium.com/@nedsoft/how-to-fix-posttoolargeexception-in-laravel-on-apache-server-4dbdb7cdaaac">ref</a></li>
</ul>
<pre><code class="language-sh">php -i | grep php.ini
# edit file config - php.ini: 
post_max_size = 2G
upload_max_filesize = 1G
memory_limit = 3G

sudo /etc/init.d/apache2 restart
</code></pre>
<h2 id="user-login---register---logout---default-guard"><a class="header" href="#user-login---register---logout---default-guard">User Login - Register - Logout - Default Guard</a></h2>
<h3 id="controller---user"><a class="header" href="#controller---user">Controller - User</a></h3>
<pre><code class="language-php">class AuthUserController extends Controller
{
    public function showLoginForm()
    {
        return view('login');
    }

    public function login(Request $request)
    {
        $credentials = $request-&gt;only('email', 'password');

        if (Auth::attempt($credentials)) {
            return redirect()-&gt;intended('/');
        }

        return back()-&gt;withErrors([
            'email' =&gt; 'The provided credentials do not match our records.',
        ]);
    }

    public function showRegistrationForm()
    {
        return view('register');
    }

    public function register(Request $request)
    {
        $request-&gt;validate([
            'name' =&gt; 'required|string|max:255',
            'email' =&gt; 'required|string|email|max:255|unique:users',
            'password' =&gt; 'required|string|min:6|confirmed',
        ]);

        $user = new User([
            'name' =&gt; $request-&gt;name,
            'email' =&gt; $request-&gt;email,
            'password' =&gt; Hash::make($request-&gt;password),
        ]);

        $user-&gt;save();

        return redirect()-&gt;route('login')-&gt;with('success', 'Registration successful. Please login.');
    }

    public function logout()
    {
        Auth::logout();
        return redirect('/');
    }
}

</code></pre>
<h3 id="route---user"><a class="header" href="#route---user">Route - User</a></h3>
<pre><code class="language-php">// login - register - logout
Route::middleware(['guest'])-&gt;group(function () {
    Route::get('/login', [AuthUserController::class, 'showLoginForm'])-&gt;name('login');
    Route::post('/login', [AuthUserController::class, 'login'])-&gt;name('login.post');
    Route::get('/register', [AuthUserController::class, 'showRegistrationForm'])-&gt;name('register');
    Route::post('/register', [AuthUserController::class, 'register'])-&gt;name('register.post');
});

Route::post('/logout', [AuthUserController::class, 'logout'])-&gt;name('logout');

// authen pages
Route::middleware(['auth'])-&gt;group(function () {
    Route::get('/cart', function () {
        return view('shop.pages.cart');
    })-&gt;name('shop.cart');
});

</code></pre>
<h3 id="middleware---user"><a class="header" href="#middleware---user">Middleware - User</a></h3>
<pre><code class="language-php">class UserRedirectIfAuthenticated
{
    /**
     * Handle an incoming request.
     *
     * @param  \Closure(\Illuminate\Http\Request): (\Symfony\Component\HttpFoundation\Response)  $next
     */
    public function handle(Request $request, Closure $next): Response
    {
        if (Auth::check()) {
            return redirect('/')-&gt;with('warning', 'Are you serious???');
        }

        return $next($request);
    }
}

</code></pre>
<h3 id="bootstrapappphp---user"><a class="header" href="#bootstrapappphp---user">bootstrap/app.php - User</a></h3>
<pre><code class="language-php">return Application::configure(basePath: dirname(__DIR__))
    -&gt;withRouting(
        web: __DIR__ . '/../routes/web.php',
        commands: __DIR__ . '/../routes/console.php',
        health: '/up',
    )
    -&gt;withMiddleware(function (Middleware $middleware) {
        $middleware-&gt;alias([
            'admin' =&gt; AdminAuthMiddleware::class,
            'guest.admin' =&gt; AdminRedirectIfAuthenticated::class,
            'guest' =&gt; UserRedirectIfAuthenticated::class,
        ]);
    })
    -&gt;withExceptions(function (Exceptions $exceptions) {
        //
    })-&gt;create();

</code></pre>
<h2 id="admin---login---logout---custom-guard"><a class="header" href="#admin---login---logout---custom-guard">Admin - Login - Logout - Custom Guard</a></h2>
<h3 id="controller---admin"><a class="header" href="#controller---admin">Controller - Admin</a></h3>
<pre><code class="language-php">class AuthAdminController extends Controller
{
    public function showLoginForm()
    {
        return view('admin.pages.login');
    }

    public function login(Request $request)
    {
        $credentials = $request-&gt;only('email', 'password');

        if (Auth::guard('admin')-&gt;attempt($credentials)) {
            return redirect()-&gt;intended('admin/')-&gt;with('success', 'Login successfully');
        }

        return back()-&gt;withErrors([
            'email' =&gt; 'The provided credentials do not match our records.',
        ]);
    }

    public function logout()
    {
        Auth::guard('admin')-&gt;logout();
        return redirect('/admin/login')-&gt;with('success', 'Logout successfully');
    }
}

</code></pre>
<h3 id="route---admin"><a class="header" href="#route---admin">Route - Admin</a></h3>
<pre><code class="language-php">Route::prefix('admin')-&gt;group(function () {
    // authen admin
    Route::middleware('admin')-&gt;group(function () {
        // authen pages
        // .............
    });

    // admin - login - logout
    Route::group(['middleware' =&gt; 'guest.admin'], function () {
        Route::get('/login', [AuthAdminController::class, 'showLoginForm'])-&gt;name('admin.login');
        Route::post('/login', [AuthAdminController::class, 'login'])-&gt;name('admin.login.post');
    });
    Route::get('/logout', [AuthAdminController::class, 'logout'])-&gt;name('admin.logout');
});

</code></pre>
<h3 id="middleware---admin"><a class="header" href="#middleware---admin">Middleware - Admin</a></h3>
<pre><code class="language-php">class AdminAuthMiddleware
{
    /**
     * Handle an incoming request.
     *
     * @param  \Closure(\Illuminate\Http\Request): (\Symfony\Component\HttpFoundation\Response)  $next
     */

    public function handle(Request $request, Closure $next)
    {
        if (!Auth::guard('admin')-&gt;check()) {
            return redirect('admin/login')-&gt;with('error', 'Please login to access the admin area.');
        }

        return $next($request);
    }
}

</code></pre>
<pre><code class="language-php">class AdminRedirectIfAuthenticated
{
    /**
     * Handle an incoming request.
     *
     * @param  \Closure(\Illuminate\Http\Request): (\Symfony\Component\HttpFoundation\Response)  $next
     */

    public function handle($request, Closure $next, $guard = 'admin')
    {
        if (Auth::guard($guard)-&gt;check()) {
            return redirect('admin/')-&gt;with('warning', 'Are you serious???');
        }

        return $next($request);
    }
}

</code></pre>
<ul>
<li><strong>bootstrap/app.php</strong></li>
</ul>
<pre><code class="language-php">return Application::configure(basePath: dirname(__DIR__))
    -&gt;withRouting(
        web: __DIR__ . '/../routes/web.php',
        commands: __DIR__ . '/../routes/console.php',
        health: '/up',
    )
    -&gt;withMiddleware(function (Middleware $middleware) {
        $middleware-&gt;alias([
            'admin' =&gt; AdminAuthMiddleware::class,
            'guest.admin' =&gt; AdminRedirectIfAuthenticated::class,
            'guest' =&gt; UserRedirectIfAuthenticated::class,
        ]);
    })
    -&gt;withExceptions(function (Exceptions $exceptions) {
        //
    })-&gt;create();

</code></pre>
<h3 id="configauthphp"><a class="header" href="#configauthphp">config/auth.php</a></h3>
<pre><code class="language-php">return [
    'guards' =&gt; [
        // Các guard khác...

        'admin' =&gt; [
            'driver' =&gt; 'session',
            'provider' =&gt; 'admins',
        ],
    ],

    'providers' =&gt; [
        // Các provider khác...

        'admins' =&gt; [
            'driver' =&gt; 'eloquent',
            'model' =&gt; App\Models\Admin::class,
        ],
    ],

    // Các cài đặt khác...
];


</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../blogs/Laravel/Takenote.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../blogs/Laravel/Takenote3.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../blogs/Laravel/Takenote.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../blogs/Laravel/Takenote3.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
